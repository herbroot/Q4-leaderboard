<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>NL2SQL Multi-Benchmark Leaderboard</title>

  <!-- 本地依赖（保持你仓库中的路径） -->
  <link rel="stylesheet" href="./assets/bootstrap.min.css"/>
  <link rel="stylesheet" href="./assets/dataTables.bootstrap5.min.css"/>

  <style>
    body { background:#f7f9fc; }
    .brand { font-weight:800; letter-spacing:.3px; }
    .subtle { color:#6c757d; }
    .score { font-weight:700; }
    .table thead th { white-space:nowrap; }

    /* 让表头与内容稳定对齐 */
    table.leaderboard-table { table-layout: fixed; width: 100%; }
    table.leaderboard-table th:nth-child(1),
    table.leaderboard-table td:nth-child(1){ width: 80px; }
    table.leaderboard-table th:nth-child(2),
    table.leaderboard-table td:nth-child(2){ width: 60%; }
    table.leaderboard-table th:nth-child(3),
    table.leaderboard-table td:nth-child(3){ width: 200px; }
    .dataTables_scrollHeadInner,
    .dataTables_scrollHeadInner > table { width: 100% !important; }

    /* 精简 DataTables UI：保留搜索与分页 */
    .dataTables_length, .dataTables_info { display: none !important; }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="brand h3 mb-0">NL2SQL Multi-Benchmark Leaderboard</h1>
      <!-- 右上角副标题已移除 -->
    </div>

    <!-- 顶部 Tab -->
    <ul class="nav nav-tabs" id="benchTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="tab-1" data-bs-toggle="tab" data-bs-target="#panel-1" type="button" role="tab" aria-selected="true">Spider</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-2" data-bs-toggle="tab" data-bs-target="#panel-2" type="button" role="tab" aria-selected="false">SQL-Eval (Overall)</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-3" data-bs-toggle="tab" data-bs-target="#panel-3" type="button" role="tab" aria-selected="false">BIRD</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-4" data-bs-toggle="tab" data-bs-target="#panel-4" type="button" role="tab" aria-selected="false">NL2GQL</button>
      </li>
    </ul>

    <div class="tab-content pt-3">

      <!-- ===== Spider ===== -->
      <div class="tab-pane fade show active" id="panel-1" role="tabpanel" aria-labelledby="tab-1"
           data-raw="model,exec,exact match
Qwen3-Coder-30B-A3B-Instruct,49.50%,42.60%
Qwen2.5-Coder-14B-Instruct,56.20%,50.80%
Qwen2.5-Coder-7B-Instruct,56.20%,50.80%
Qwen2.5-Coder-32B-Instruct,61.10%,53.60%
XiYanSQL-QwenCoder-32B-2504,79.40%,75.60%
XiYanSQL-QwenCoder-14B-2504,77.90%,74.60%
XiYanSQL-QwenCoder-7B-2504,53.80%,50.90%
deepseek-coder-33b-instruct,45.00%,38.00%
deepseek-coder-6.7b-instruct,37.60%,31.50%
CodeLlama-34b-Instruct-hf,41.50%,33.70%
CodeLlama-13b-Instruct-hf,48.10%,36.00%
CodeLlama-7b-Instruct-hf,39.10%,28.10%
Seed-Coder-8B-Instruct,37.40%,31.40%">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title mb-3">Leaderboard</h5>
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle leaderboard-table" style="width:100%">
                <thead>
                <tr>
                  <th>Rank</th>
                  <th>Model</th>
                  <th>Score (execute accuracy)</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- ===== SQL-Eval ===== -->
      <div class="tab-pane fade" id="panel-2" role="tabpanel" aria-labelledby="tab-2"
           data-raw="model,score
XiYanSQL-QwenCoder-32B-2504,69.05%
XiYanSQL-QwenCoder-14B,71.14%
XiYanSQL-QwenCoder-7B,76.70%
Qwen2.5-Coder-7B-Instruct（glmprompt）,74.40%
Qwen2.5-Coder-14B-Instruct（glmprompt）,73.26%
Qwen2.5-Coder-7B-Instruct（glmprompt）,67.55%
Qwen3-Coder-30B-A3B-Instruct,78.20%
deepseek-coder-6.7b-instruct,57.65%
deepseek-coder-33b-instruct,71.37%
CodeLlama-7b-Instruct-hf,26.15%
deepseek-coder-33b-instruct,71.37%
Seed-Coder-8B-Instruct（glmprompt）,67.73%">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title mb-3">Leaderboard</h5>
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle leaderboard-table" style="width:100%">
                <thead>
                <tr>
                  <th>Rank</th>
                  <th>Model</th>
                  <th>Score (execute accuracy)</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- ===== BIRD ===== -->
      <div class="tab-pane fade" id="panel-3" role="tabpanel" aria-labelledby="tab-3"
           data-raw="model,score
XiYanSQL-QwenCoder-32B-2504,40.50125
Qwen3-Coder-30B-A3B-Instruct,33.42125
Qwen2.5-Coder-32B-Instruct,17.001875
Qwen2.5-Coder-7B-Instruct,32.745625
deepseek-coder-33b-instruct,33.838125
Qwen2.5-Coder-14B-Instruct,36.478125
deepseek-coder-6.7b-instruct,24.389375
CodeLlama-34b-Instruct-hf,16.83875
CodeLlama-13b-Instruct-hf,16.0975
CodeLlama-7b-Instruct-hf,16.453125
Seed-Coder-8B-Instruct,28.52625
XiYanSQL-QwenCoder-14B,24.898125
XiYanSQL-QwenCoder-7B,30.88">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title mb-3">Leaderboard</h5>
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle leaderboard-table" style="width:100%">
                <thead>
                <tr>
                  <th>Rank</th>
                  <th>Model</th>
                  <th>Score (execute accuracy)</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- ===== NL2GQL ===== -->
      <div class="tab-pane fade" id="panel-4" role="tabpanel" aria-labelledby="tab-4"
           data-raw="model,score
XiYanSQL-QwenCoder-32B-2504,54.01%
Qwen3-Coder-30B-A3B-Instruct,49.29%
Qwen2.5-Coder-32B-Instruct,44.03%
Qwen2.5-Coder-7B-Instruct,33.21%
deepseek-coder-33b-instruct,37.92%
Qwen2.5-Coder-14B-Instruct,54.08%
deepseek-coder-6.7b-instruct,44.12%
CodeLlama-34b-Instruct-hf,40.42%
CodeLlama-13b-Instruct-hf,39.40%
CodeLlama-7b-Instruct-hf,43.99%
Seed-Coder-8B-Instruct,46.39%
XiYanSQL-QwenCoder-14B,30.34%
XiYanSQL-QwenCoder-7B,38.61%">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title mb-3">Leaderboard</h5>
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle leaderboard-table" style="width:100%">
                <thead>
                <tr>
                  <th>Rank</th>
                  <th>Model</th>
                  <th>Score (execute accuracy)</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

    </div><!-- /.tab-content -->
  </div><!-- /.container -->

  <!-- 本地 JS（顺序不能乱） -->
  <script src="./assets/jquery-3.7.1.min.js"></script>
  <script src="./assets/bootstrap.bundle.min.js"></script>
  <script src="./assets/papaparse.min.js"></script>
  <script src="./assets/jquery.dataTables.min.js"></script>
  <script src="./assets/dataTables.bootstrap5.min.js"></script>

  <script>
    // —— 小工具 —— //
    const norm = s => String(s||'').trim().toLowerCase();
    function parseCSV(text){
      const out = Papa.parse(String(text||'').trim(), {header:true, skipEmptyLines:true});
      return out.data || [];
    }
    function pick(row, keys){
      const map = Object.fromEntries(Object.keys(row).map(k => [norm(k), k]));
      const hit = keys.find(k => map[k]);
      return hit ? row[map[hit]] : '';
    }

    // 生成表格
    function renderPane(pane){
      const raw = pane.getAttribute('data-raw') || '';
      if(!raw.trim()) return;

      // 解析行：优先 score；否则回落 exec / exact match
      const rows = parseCSV(raw).map(r => {
        const model = pick(r, ['model','method','name','模型','方法']);
        let score = parseFloat(String(pick(r, ['score','acc','accuracy','平均','score(%)'])).replace(/[^0-9.+-]/g,''));
        if(!Number.isFinite(score)){
          const exec = parseFloat(String(pick(r, ['exec','执行'])).replace(/[^0-9.+-]/g,''));
          const em   = parseFloat(String(pick(r, ['exact match','exact_match','em','精确匹配'])).replace(/[^0-9.+-]/g,''));
          if(Number.isFinite(exec)) score = exec; else if(Number.isFinite(em)) score = em;
        }
        return {model, score};
      }).filter(r => r.model && Number.isFinite(r.score));

      // 排序 & 填充 tbody
      rows.sort((a,b)=> b.score - a.score);
      const $table = $(pane).find('table.leaderboard-table');
      const tbody = $table.find('tbody').empty()[0];
      rows.forEach((r, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="fw-semibold text-nowrap">${i+1}</td>
          <td class="fw-semibold">${r.model}</td>
          <td class="score text-nowrap">${(Math.round(r.score*100)/100).toFixed(2)}</td>`;
        tbody.appendChild(tr);
      });

      // 初始化 DataTable（只留搜索与分页）
      if ($.fn.dataTable.isDataTable($table)) $table.DataTable().destroy();
      const dt = $table.DataTable({
        pageLength: 25,
        deferRender: true,
        autoWidth: false,
        scrollX: false,
        order: [[2,'desc']],
        lengthChange: false,
        info: false,
        searching: true,
        dom: 'tpr',  // table + paging + processing
        columnDefs: [
          { targets: 0, className:'text-nowrap', width: 80 },
          { targets: 1, width: '60%' },
          { targets: 2, className:'text-nowrap', width: 200 }
        ]
      });
      dt.columns.adjust();
    }

    // 初始化所有面板
    document.querySelectorAll('.tab-pane').forEach(renderPane);

    // Tab 切换后修正列宽
    document.querySelectorAll('button[data-bs-toggle="tab"]').forEach(btn => {
      btn.addEventListener('shown.bs.tab', e => {
        const pane = document.querySelector(e.target.getAttribute('data-bs-target'));
        const tbl = $(pane).find('table.leaderboard-table');
        if ($.fn.dataTable.isDataTable(tbl)) tbl.DataTable().columns.adjust();
      });
    });

    // 窗口尺寸变化时也调整
    window.addEventListener('resize', () => {
      $('.leaderboard-table').each(function(){
        if ($.fn.dataTable.isDataTable(this)) $(this).DataTable().columns.adjust();
      });
    });
  </script>
</body>
</html>
